<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Global tests in multiverse analysis — global_tests • pima</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Global tests in multiverse analysis — global_tests"><meta name="description" content="Tests global null hypotheses for weak control of the Family-Wise Error Rate, considering one or more parameters within a multiverse of models."><meta property="og:description" content="Tests global null hypotheses for weak control of the Family-Wise Error Rate, considering one or more parameters within a multiverse of models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pima</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/livioivil/pima/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Global tests in multiverse analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/livioivil/pima/blob/main/R/global_tests.R" class="external-link"><code>R/global_tests.R</code></a></small>
      <div class="d-none name"><code>global_tests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Tests global null hypotheses for weak control of the Family-Wise Error Rate, considering one or more parameters within a multiverse of models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">global_tests</span><span class="op">(</span><span class="va">obj</span>, by <span class="op">=</span> <span class="cn">NULL</span>, comb_funct <span class="op">=</span> <span class="st">"maxT"</span>, comb_factors <span class="op">=</span> <span class="cn">FALSE</span>, comb_factors_funct <span class="op">=</span> <span class="st">"Mahalanobis"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>a <code>jointest</code> object, e.g., produced by <code><a href="pima.html">pima</a></code>.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>mode of combination (<code>NULL</code>, <code>Coeff</code>, <code>Model</code>, <code>individual</code>).
If <code>NULL</code> (default), a single global null hypothesis is tested.</p></dd>


<dt id="arg-comb-funct">comb_funct<a class="anchor" aria-label="anchor" href="#arg-comb-funct"></a></dt>
<dd><p>combining function (see <code>combine-methods</code> for more datails).</p></dd>


<dt id="arg-comb-factors">comb_factors<a class="anchor" aria-label="anchor" href="#arg-comb-factors"></a></dt>
<dd><p>logical. If <code>FALSE</code>, coefficients for the levels of factor variables are considered separately.
If <code>TRUE</code>, a single global test is performed for each factor variable.</p></dd>


<dt id="arg-comb-factors-funct">comb_factors_funct<a class="anchor" aria-label="anchor" href="#arg-comb-factors-funct"></a></dt>
<dd><p>combining function for contrasts of factor variables (see <code>combine_contrasts</code> for more datails).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>jointest</code>, containing:</p><ul><li><p><code>Tspace</code>: data frame of test statistics, where columns correspond to tests, and rows to sign-flipping transformations
(the first is the identity).</p></li>
<li><p><code>summary_table</code>: data frame containing a summary for each test:
combined test statistic and p-value.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function builds on the functions <code>combine</code> and <code>combine_contrasts</code> of the <strong>jointest</strong> package.</p>
<p>In the default <code>by = NULL</code>, the procedure tests the global null hypothesis
that there are no significant effects (all considered coefficients in all models are null)
against the alternative that there is at least one significant effect
(one non-null coefficient in one model). Other inputs of the argument <code>by</code>
test analogous null hypotheses, defined by model (<code>Model</code>), by coefficient (<code>Coeff</code>) or individually (<code>individual</code>).</p>
<p>The argument <code>comb_factors</code> affects only categorical predictors. For each categorical predictor, by default (<code>FALSE</code>), non-baseline coefficients are considered separately.
If <code>TRUE</code>, a single global test is performed by combining the tests derived from the contrasts
with the function specified by <code>comb_factors_funct</code>.</p>
<p>With the option <code>by = "individual"</code>, the input p-values are returned unchanged,
except when categorical predictors are present and <code>comb_factors = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Girardi, Vesely, Lakens, Altoè, Pastore, Calcagnì, Finos (2024). Post-selection Inference in Multiverse Analysis (PIMA): An Inferential Framework Based on the Sign Flipping Score Test. Psychometrika, doi: 10.1007/s11336-024-09973-6.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                X3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                Z1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, Z2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span><span class="op">$</span><span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">D</span><span class="op">$</span><span class="va">X3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">$</span><span class="va">X1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">D</span><span class="op">$</span><span class="va">X3</span> <span class="op">==</span> <span class="st">"C"</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="va">D</span><span class="op">$</span><span class="va">Z1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiverse of 4 models (list)</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">Z1</span> <span class="op">+</span> <span class="va">Z2</span>, data <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">Z1</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">Z2</span>, data <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">Z1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">Z2</span>,<span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">Z1</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">Z2</span>,<span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod1 <span class="op">=</span> <span class="va">mod1</span>, mod2 <span class="op">=</span> <span class="va">mod2</span>, mod3 <span class="op">=</span> <span class="va">mod3</span>, mod4 <span class="op">=</span> <span class="va">mod4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test selected coefficients (raw and adjusted p-values)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="pima.html">pima</a></span><span class="op">(</span><span class="va">mods</span>, tested_coeffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3B"</span>,<span class="st">"X3C"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in loadNamespace(x):</span> there is no package called ‘jointest’</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'res' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Global p-values: overall, by model and by coefficient</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">global_tests</span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in loadNamespace(x):</span> there is no package called ‘jointest’</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">global_tests</span><span class="op">(</span><span class="va">res</span>, by <span class="op">=</span> <span class="st">"Model"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in match.arg(by, choices = c("coefficient", "model", "individual")):</span> 'arg' should be one of “coefficient”, “model”, “individual”</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">global_tests</span><span class="op">(</span><span class="va">res</span>, by <span class="op">=</span> <span class="st">"Coeff"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in match.arg(by, choices = c("coefficient", "model", "individual")):</span> 'arg' should be one of “coefficient”, “model”, “individual”</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Global tests for each factor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">global_tests</span><span class="op">(</span><span class="va">res</span>, by <span class="op">=</span> <span class="st">"individual"</span>, comb_factors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in loadNamespace(x):</span> there is no package called ‘jointest’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># These tests can be aggregated as before (e.g., by coefficient)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">global_tests</span><span class="op">(</span><span class="va">res</span>, by <span class="op">=</span> <span class="st">"Coeff"</span>, comb_factors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in match.arg(by, choices = c("coefficient", "model", "individual")):</span> 'arg' should be one of “coefficient”, “model”, “individual”</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Filippo Gambarota.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

